function data = response(rParams)
persistent fnames;
if isempty(fnames)
    fnames = fieldnames(rParams);
    for i = 1:length(fnames)
        eval(['persistent ',fnames{i},';']);
        eval([fnames{i}, '=getfield(rParams,fnames{i});']);
    end
end

persistent nsampled;
if isempty(nsampled)
    nsampled = 0;
end

if ai.SamplesAcquired > nsampled
    peekdata(ai,n